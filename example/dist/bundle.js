require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var React = require('react');

var AutosuggestItem = React.createClass({displayName: "AutosuggestItem",
  /**
   * Get the default props
   * @return {Object} The props
   */
  getDefaultProps: function() {
    return {
      isActive: false,
      suggest: {
        label: ''
      },
      onSuggestSelect: function() {}
    };
  },

  /**
   * When the element gets clicked
   * @param  {Event} event The click event
   */
  onClick: function(event) {
    event.preventDefault();
    this.props.onSuggestSelect(this.props.suggest);
  },

  /**
   * Render the view
   */
  render: function() {
    return (
      React.createElement("li", {className: this.getSuggestClasses(), 
        onClick: this.onClick}, 
          this.props.suggest.label
      )
    );
  },

  /**
   * The classes for the suggest item
   * @return {String} The classes
   */
  getSuggestClasses: function() {
    var classes = 'autosuggest-item';

    classes += this.props.isActive ? ' autosuggest-item--active' : '';

    return classes;
  }
});

module.exports = AutosuggestItem;


},{"react":undefined}],"Haribabu":[function(require,module,exports){
var React = require('react'),
  AutosuggestItem = require('./AutosuggestItem.jsx'),
  superagent = require("superagent");

var Autosuggest = React.createClass({displayName: "Autosuggest",
  /**
   * Get the default props
   * @return {Object} The state
   */
  getDefaultProps: function() {
    return {
      fixtures: [],
      placeholder: 'Search',
      onSuggestSelect: function() {},
      location: null,
      radius: 0
    };
  },

  /**
   * Get the initial state
   * @return {Object} The state
   */
  getInitialState: function() {
    return {
      isSuggestsHidden: true,
      userInput: '',
      activeSuggest: null,
      suggests: [],
      autocoder: new google.maps.Geocoder(),
      autocompleteService: new google.maps.places.AutocompleteService()
    };
  },

  /**
   * When the input got changed
   */
  onInputChange: function() {
    var userInput = this.refs.autosuggestInput.getDOMNode().value;

    this.setState({userInput: userInput}, function() {
      if (!userInput) {
        this.updateSuggests();
      }
    }.bind(this));

    if (!userInput) {
      return;
    }

    this.state.autocompleteService.getPlacePredictions({
      input: userInput,
      location: this.props.location || new google.maps.LatLng(0, 0),
      radius: this.props.radius
    }, function(suggestsGoogle) {
      this.updateSuggests(suggestsGoogle);
    }.bind(this));
  },

  /**
   * Update the suggests
   * @param  {Object} suggestsGoogle The new google suggests
   */
  updateSuggests: function(suggestsGoogle) {
    if (!suggestsGoogle) {
      suggestsGoogle = [];
    }

    var suggests = [],
      regex = new RegExp(this.state.userInput, 'gim'),
      suggestItems;

    this.props.fixtures.forEach(function(suggest) {
      if (suggest.label.match(regex)) {
        suggest.placeId = suggest.label;
        suggests.push(suggest);
      }
    }.bind(this));

    suggestsGoogle.forEach(function(suggest) {
      suggests.push({
        label: suggest.description,
        placeId: suggest.place_id
      });
    }.bind(this));

    this.setState({suggests: suggests});
  },

  /**
   * When the input gets focused
   * @param  {Event} event The focus event
   */
  showSuggests: function(event) {
    this.updateSuggests();

    this.setState({isSuggestsHidden: false});
  },

  /**
   * When the input loses focused
   * @param  {Event} event The focus event
   */
  hideSuggests: function(event) {
    setTimeout(function() {
      this.setState({isSuggestsHidden: true});
    }.bind(this), 100);
  },

  /**
   * When a key gets pressed in the input
   * @param  {Event} event The keypress event
   */
  onInputKeyDown: function(event) {
    switch (event.which) {
      case 40: // DOWN
        event.preventDefault();
        this.activateSuggest('next');
        break;
      case 38: // UP
        event.preventDefault();
        this.activateSuggest('prev');
        break;
      case 13: // ENTER
        this.selectSuggest(this.state.activeSuggest);
        break;
      case 9: // TAB
        this.selectSuggest(this.state.activeSuggest);
        break;
      case 27: // ESC
        this.hideSuggests();
        break;
    }
  },

  /**
   * Activate a new suggest
   * @param {String} direction The direction in which to activate new suggest
   */
  activateSuggest: function(direction) {
    var suggestsCount = this.state.suggests.length - 1,
      next = direction === ('next'),
      newActiveSuggest = null,
      newIndex = 0,
      i = 0;

    for (i; i <= suggestsCount; i++) {
      if (this.state.suggests[i] === this.state.activeSuggest) {
        newIndex = next ? i + 1 : i - 1;
      }
    }

    if (!this.state.activeSuggest) {
      newIndex = next ? 0 : suggestsCount;
    }

    if (newIndex >= 0 && newIndex <= suggestsCount) {
      newActiveSuggest = this.state.suggests[newIndex];
    }

    this.setState({activeSuggest: newActiveSuggest});
  },

  /**
   * When an item got selected
   * @param {AutosuggestItem} suggest The selected suggest item
   */
  selectSuggest: function(suggest) {
    if (!suggest) {
      suggest = {
        label: this.state.userInput
      };
    }

    this.setState({
      isSuggestsHidden: true,
      userInput: suggest.label
    });

    if (suggest.location) {
      this.props.onSuggestSelect(suggest);
      return;
    }

    this.autocodeSuggest(suggest);
  },

  /**
   * autocode a suggest
   * @param  {Object} suggest The suggest
   */
  autocodeSuggest: function(suggest) {
    var location;

    this.state.autocoder.autocode(
      {address: suggest.label},
      function(results, status) {
        if (status !== google.maps.GeocoderStatus.OK) {
          return;
        }

        location = results[0].geometry.location;

        suggest.location = {
          lat: location.lat(),
          lng: location.lng()
        };

        this.props.onSuggestSelect(suggest);
      }.bind(this)
    );
  },

  /**
   * Render the view
   */
  render: function() {
    return (
      React.createElement("div", {className: "autosuggest", onClick: this.onClick}, 
        React.createElement("input", {
          className: "autosuggest__input", 
          ref: "autosuggestInput", 
          type: "text", 
          value: this.state.userInput, 
          placeholder: this.props.placeholder, 
          onKeyDown: this.onInputKeyDown, 
          onChange: this.onInputChange, 
          onFocus: this.showSuggests, 
          onBlur: this.hideSuggests}), 
        React.createElement("ul", {className: this.getSuggestsClasses()}, 
          this.getSuggestItems()
        )
      )
    );
  },

  /**
   * Get the suggest items for the list
   * @return {Array} The suggestions
   */
  getSuggestItems: function() {
    return this.state.suggests.map(function(suggest) {
      var isActive = (this.state.activeSuggest &&
        suggest.placeId === this.state.activeSuggest.placeId);

      return (
        React.createElement(AutosuggestItem, {
          key: suggest.placeId, 
          suggest: suggest, 
          isActive: isActive, 
          onSuggestSelect: this.selectSuggest})
      );
    }.bind(this));
  },

  /**
   * The classes for the suggests list
   * @return {String} The classes
   */
  getSuggestsClasses: function() {
    var classes = 'autosuggest__suggests'

    classes += this.state.isSuggestsHidden ?
      ' autosuggest__suggests--hidden' : '';

    return classes;
  }
});

module.exports = Autosuggest;


},{"./AutosuggestItem.jsx":1,"react":undefined,"superagent":undefined}]},{},[])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9yZWFjdC1jb21wb25lbnQtZ3VscC10YXNrcy9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL2hvbWUvaGFyaWJhYnV2aXN3YW5hdGgvcmVhY3QtYXV0b3N1Z2dlc3Qvc3JjL0F1dG9zdWdnZXN0SXRlbS5qc3giLCIvaG9tZS9oYXJpYmFidXZpc3dhbmF0aC9yZWFjdC1hdXRvc3VnZ2VzdC9zcmMvQXV0b3N1Z2dlc3QuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztBQUU3QixJQUFJLHFDQUFxQywrQkFBQTtBQUN6QztBQUNBO0FBQ0E7O0VBRUUsZUFBZSxFQUFFLFdBQVc7SUFDMUIsT0FBTztNQUNMLFFBQVEsRUFBRSxLQUFLO01BQ2YsT0FBTyxFQUFFO1FBQ1AsS0FBSyxFQUFFLEVBQUU7T0FDVjtNQUNELGVBQWUsRUFBRSxXQUFXLEVBQUU7S0FDL0IsQ0FBQztBQUNOLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7RUFFRSxPQUFPLEVBQUUsU0FBUyxLQUFLLEVBQUU7SUFDdkIsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3ZCLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDbkQsR0FBRztBQUNIO0FBQ0E7QUFDQTs7RUFFRSxNQUFNLEVBQUUsV0FBVztJQUNqQjtNQUNFLG9CQUFBLElBQUcsRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUUsSUFBSSxDQUFDLGlCQUFpQixFQUFFLEVBQUM7UUFDdEMsT0FBQSxFQUFPLENBQUUsSUFBSSxDQUFDLE9BQVMsQ0FBQSxFQUFBO1VBQ3BCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQU07TUFDekIsQ0FBQTtNQUNMO0FBQ04s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IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIEF1dG9zdWdnZXN0SXRlbSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgLyoqXG4gICAqIEdldCB0aGUgZGVmYXVsdCBwcm9wc1xuICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBwcm9wc1xuICAgKi9cbiAgZ2V0RGVmYXVsdFByb3BzOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNBY3RpdmU6IGZhbHNlLFxuICAgICAgc3VnZ2VzdDoge1xuICAgICAgICBsYWJlbDogJydcbiAgICAgIH0sXG4gICAgICBvblN1Z2dlc3RTZWxlY3Q6IGZ1bmN0aW9uKCkge31cbiAgICB9O1xuICB9LFxuXG4gIC8qKlxuICAgKiBXaGVuIHRoZSBlbGVtZW50IGdldHMgY2xpY2tlZFxuICAgKiBAcGFyYW0gIHtFdmVudH0gZXZlbnQgVGhlIGNsaWNrIGV2ZW50XG4gICAqL1xuICBvbkNsaWNrOiBmdW5jdGlvbihldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5wcm9wcy5vblN1Z2dlc3RTZWxlY3QodGhpcy5wcm9wcy5zdWdnZXN0KTtcbiAgfSxcblxuICAvKipcbiAgICogUmVuZGVyIHRoZSB2aWV3XG4gICAqL1xuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8bGkgY2xhc3NOYW1lPXt0aGlzLmdldFN1Z2dlc3RDbGFzc2VzKCl9XG4gICAgICAgIG9uQ2xpY2s9e3RoaXMub25DbGlja30+XG4gICAgICAgICAge3RoaXMucHJvcHMuc3VnZ2VzdC5sYWJlbH1cbiAgICAgIDwvbGk+XG4gICAgKTtcbiAgfSxcblxuICAvKipcbiAgICogVGhlIGNsYXNzZXMgZm9yIHRoZSBzdWdnZXN0IGl0ZW1cbiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgY2xhc3Nlc1xuICAgKi9cbiAgZ2V0U3VnZ2VzdENsYXNzZXM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjbGFzc2VzID0gJ2F1dG9zdWdnZXN0LWl0ZW0nO1xuXG4gICAgY2xhc3NlcyArPSB0aGlzLnByb3BzLmlzQWN0aXZlID8gJyBhdXRvc3VnZ2VzdC1pdGVtLS1hY3RpdmUnIDogJyc7XG5cbiAgICByZXR1cm4gY2xhc3NlcztcbiAgfVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXV0b3N1Z2dlc3RJdGVtO1xuIiwidmFyIFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKSxcbiAgQXV0b3N1Z2dlc3RJdGVtID0gcmVxdWlyZSgnLi9BdXRvc3VnZ2VzdEl0ZW0uanN4JyksXG4gIHN1cGVyYWdlbnQgPSByZXF1aXJlKFwic3VwZXJhZ2VudFwiKTtcblxudmFyIEF1dG9zdWdnZXN0ID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICAvKipcbiAgICogR2V0IHRoZSBkZWZhdWx0IHByb3BzXG4gICAqIEByZXR1cm4ge09iamVjdH0gVGhlIHN0YXRlXG4gICAqL1xuICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBmaXh0dXJlczogW10sXG4gICAgICBwbGFjZWhvbGRlcjogJ1NlYXJjaCcsXG4gICAgICBvblN1Z2dlc3RTZWxlY3Q6IGZ1bmN0aW9uKCkge30sXG4gICAgICBsb2NhdGlvbjogbnVsbCxcbiAgICAgIHJhZGl1czogMFxuICAgIH07XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCB0aGUgaW5pdGlhbCBzdGF0ZVxuICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBzdGF0ZVxuICAgKi9cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNTdWdnZXN0c0hpZGRlbjogdHJ1ZSxcbiAgICAgIHVzZXJJbnB1dDogJycsXG4gICAgICBhY3RpdmVTdWdnZXN0OiBudWxsLFxuICAgICAgc3VnZ2VzdHM6IFtdLFxuICAgICAgYXV0b2NvZGVyOiBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKSxcbiAgICAgIGF1dG9jb21wbGV0ZVNlcnZpY2U6IG5ldyBnb29nbGUubWFwcy5wbGFjZXMuQXV0b2NvbXBsZXRlU2VydmljZSgpXG4gICAgfTtcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiB0aGUgaW5wdXQgZ290IGNoYW5nZWRcbiAgICovXG4gIG9uSW5wdXRDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB1c2VySW5wdXQgPSB0aGlzLnJlZnMuYXV0b3N1Z2dlc3RJbnB1dC5nZXRET01Ob2RlKCkudmFsdWU7XG5cbiAgICB0aGlzLnNldFN0YXRlKHt1c2VySW5wdXQ6IHVzZXJJbnB1dH0sIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCF1c2VySW5wdXQpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTdWdnZXN0cygpO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICBpZiAoIXVzZXJJbnB1dCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuc3RhdGUuYXV0b2NvbXBsZXRlU2VydmljZS5nZXRQbGFjZVByZWRpY3Rpb25zKHtcbiAgICAgIGlucHV0OiB1c2VySW5wdXQsXG4gICAgICBsb2NhdGlvbjogdGhpcy5wcm9wcy5sb2NhdGlvbiB8fCBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDAsIDApLFxuICAgICAgcmFkaXVzOiB0aGlzLnByb3BzLnJhZGl1c1xuICAgIH0sIGZ1bmN0aW9uKHN1Z2dlc3RzR29vZ2xlKSB7XG4gICAgICB0aGlzLnVwZGF0ZVN1Z2dlc3RzKHN1Z2dlc3RzR29vZ2xlKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIHN1Z2dlc3RzXG4gICAqIEBwYXJhbSAge09iamVjdH0gc3VnZ2VzdHNHb29nbGUgVGhlIG5ldyBnb29nbGUgc3VnZ2VzdHNcbiAgICovXG4gIHVwZGF0ZVN1Z2dlc3RzOiBmdW5jdGlvbihzdWdnZXN0c0dvb2dsZSkge1xuICAgIGlmICghc3VnZ2VzdHNHb29nbGUpIHtcbiAgICAgIHN1Z2dlc3RzR29vZ2xlID0gW107XG4gICAgfVxuXG4gICAgdmFyIHN1Z2dlc3RzID0gW10sXG4gICAgICByZWdleCA9IG5ldyBSZWdFeHAodGhpcy5zdGF0ZS51c2VySW5wdXQsICdnaW0nKSxcbiAgICAgIHN1Z2dlc3RJdGVtcztcblxuICAgIHRoaXMucHJvcHMuZml4dHVyZXMuZm9yRWFjaChmdW5jdGlvbihzdWdnZXN0KSB7XG4gICAgICBpZiAoc3VnZ2VzdC5sYWJlbC5tYXRjaChyZWdleCkpIHtcbiAgICAgICAgc3VnZ2VzdC5wbGFjZUlkID0gc3VnZ2VzdC5sYWJlbDtcbiAgICAgICAgc3VnZ2VzdHMucHVzaChzdWdnZXN0KTtcbiAgICAgIH1cbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgc3VnZ2VzdHNHb29nbGUuZm9yRWFjaChmdW5jdGlvbihzdWdnZXN0KSB7XG4gICAgICBzdWdnZXN0cy5wdXNoKHtcbiAgICAgICAgbGFiZWw6IHN1Z2dlc3QuZGVzY3JpcHRpb24sXG4gICAgICAgIHBsYWNlSWQ6IHN1Z2dlc3QucGxhY2VfaWRcbiAgICAgIH0pO1xuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHtzdWdnZXN0czogc3VnZ2VzdHN9KTtcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiB0aGUgaW5wdXQgZ2V0cyBmb2N1c2VkXG4gICAqIEBwYXJhbSAge0V2ZW50fSBldmVudCBUaGUgZm9jdXMgZXZlbnRcbiAgICovXG4gIHNob3dTdWdnZXN0czogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGlzLnVwZGF0ZVN1Z2dlc3RzKCk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHtpc1N1Z2dlc3RzSGlkZGVuOiBmYWxzZX0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBXaGVuIHRoZSBpbnB1dCBsb3NlcyBmb2N1c2VkXG4gICAqIEBwYXJhbSAge0V2ZW50fSBldmVudCBUaGUgZm9jdXMgZXZlbnRcbiAgICovXG4gIGhpZGVTdWdnZXN0czogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNTdWdnZXN0c0hpZGRlbjogdHJ1ZX0pO1xuICAgIH0uYmluZCh0aGlzKSwgMTAwKTtcbiAgfSxcblxuICAvKipcbiAgICogV2hlbiBhIGtleSBnZXRzIHByZXNzZWQgaW4gdGhlIGlucHV0XG4gICAqIEBwYXJhbSAge0V2ZW50fSBldmVudCBUaGUga2V5cHJlc3MgZXZlbnRcbiAgICovXG4gIG9uSW5wdXRLZXlEb3duOiBmdW5jdGlvbihldmVudCkge1xuICAgIHN3aXRjaCAoZXZlbnQud2hpY2gpIHtcbiAgICAgIGNhc2UgNDA6IC8vIERPV05cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5hY3RpdmF0ZVN1Z2dlc3QoJ25leHQnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDM4OiAvLyBVUFxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmFjdGl2YXRlU3VnZ2VzdCgncHJldicpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTM6IC8vIEVOVEVSXG4gICAgICAgIHRoaXMuc2VsZWN0U3VnZ2VzdCh0aGlzLnN0YXRlLmFjdGl2ZVN1Z2dlc3QpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgOTogLy8gVEFCXG4gICAgICAgIHRoaXMuc2VsZWN0U3VnZ2VzdCh0aGlzLnN0YXRlLmFjdGl2ZVN1Z2dlc3QpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjc6IC8vIEVTQ1xuICAgICAgICB0aGlzLmhpZGVTdWdnZXN0cygpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEFjdGl2YXRlIGEgbmV3IHN1Z2dlc3RcbiAgICogQHBhcmFtIHtTdHJpbmd9IGRpcmVjdGlvbiBUaGUgZGlyZWN0aW9uIGluIHdoaWNoIHRvIGFjdGl2YXRlIG5ldyBzdWdnZXN0XG4gICAqL1xuICBhY3RpdmF0ZVN1Z2dlc3Q6IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIHZhciBzdWdnZXN0c0NvdW50ID0gdGhpcy5zdGF0ZS5zdWdnZXN0cy5sZW5ndGggLSAxLFxuICAgICAgbmV4dCA9IGRpcmVjdGlvbiA9PT0gKCduZXh0JyksXG4gICAgICBuZXdBY3RpdmVTdWdnZXN0ID0gbnVsbCxcbiAgICAgIG5ld0luZGV4ID0gMCxcbiAgICAgIGkgPSAwO1xuXG4gICAgZm9yIChpOyBpIDw9IHN1Z2dlc3RzQ291bnQ7IGkrKykge1xuICAgICAgaWYgKHRoaXMuc3RhdGUuc3VnZ2VzdHNbaV0gPT09IHRoaXMuc3RhdGUuYWN0aXZlU3VnZ2VzdCkge1xuICAgICAgICBuZXdJbmRleCA9IG5leHQgPyBpICsgMSA6IGkgLSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghdGhpcy5zdGF0ZS5hY3RpdmVTdWdnZXN0KSB7XG4gICAgICBuZXdJbmRleCA9IG5leHQgPyAwIDogc3VnZ2VzdHNDb3VudDtcbiAgICB9XG5cbiAgICBpZiAobmV3SW5kZXggPj0gMCAmJiBuZXdJbmRleCA8PSBzdWdnZXN0c0NvdW50KSB7XG4gICAgICBuZXdBY3RpdmVTdWdnZXN0ID0gdGhpcy5zdGF0ZS5zdWdnZXN0c1tuZXdJbmRleF07XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7YWN0aXZlU3VnZ2VzdDogbmV3QWN0aXZlU3VnZ2VzdH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBXaGVuIGFuIGl0ZW0gZ290IHNlbGVjdGVkXG4gICAqIEBwYXJhbSB7QXV0b3N1Z2dlc3RJdGVtfSBzdWdnZXN0IFRoZSBzZWxlY3RlZCBzdWdnZXN0IGl0ZW1cbiAgICovXG4gIHNlbGVjdFN1Z2dlc3Q6IGZ1bmN0aW9uKHN1Z2dlc3QpIHtcbiAgICBpZiAoIXN1Z2dlc3QpIHtcbiAgICAgIHN1Z2dlc3QgPSB7XG4gICAgICAgIGxhYmVsOiB0aGlzLnN0YXRlLnVzZXJJbnB1dFxuICAgICAgfTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGlzU3VnZ2VzdHNIaWRkZW46IHRydWUsXG4gICAgICB1c2VySW5wdXQ6IHN1Z2dlc3QubGFiZWxcbiAgICB9KTtcblxuICAgIGlmIChzdWdnZXN0LmxvY2F0aW9uKSB7XG4gICAgICB0aGlzLnByb3BzLm9uU3VnZ2VzdFNlbGVjdChzdWdnZXN0KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmF1dG9jb2RlU3VnZ2VzdChzdWdnZXN0KTtcbiAgfSxcblxuICAvKipcbiAgICogYXV0b2NvZGUgYSBzdWdnZXN0XG4gICAqIEBwYXJhbSAge09iamVjdH0gc3VnZ2VzdCBUaGUgc3VnZ2VzdFxuICAgKi9cbiAgYXV0b2NvZGVTdWdnZXN0OiBmdW5jdGlvbihzdWdnZXN0KSB7XG4gICAgdmFyIGxvY2F0aW9uO1xuXG4gICAgdGhpcy5zdGF0ZS5hdXRvY29kZXIuYXV0b2NvZGUoXG4gICAgICB7YWRkcmVzczogc3VnZ2VzdC5sYWJlbH0sXG4gICAgICBmdW5jdGlvbihyZXN1bHRzLCBzdGF0dXMpIHtcbiAgICAgICAgaWYgKHN0YXR1cyAhPT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsb2NhdGlvbiA9IHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb247XG5cbiAgICAgICAgc3VnZ2VzdC5sb2NhdGlvbiA9IHtcbiAgICAgICAgICBsYXQ6IGxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogbG9jYXRpb24ubG5nKClcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnByb3BzLm9uU3VnZ2VzdFNlbGVjdChzdWdnZXN0KTtcbiAgICAgIH0uYmluZCh0aGlzKVxuICAgICk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlbmRlciB0aGUgdmlld1xuICAgKi9cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhdXRvc3VnZ2VzdFwiIG9uQ2xpY2s9e3RoaXMub25DbGlja30+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIGNsYXNzTmFtZT1cImF1dG9zdWdnZXN0X19pbnB1dFwiXG4gICAgICAgICAgcmVmPVwiYXV0b3N1Z2dlc3RJbnB1dFwiXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnVzZXJJbnB1dH1cbiAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn1cbiAgICAgICAgICBvbktleURvd249e3RoaXMub25JbnB1dEtleURvd259XG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25JbnB1dENoYW5nZX1cbiAgICAgICAgICBvbkZvY3VzPXt0aGlzLnNob3dTdWdnZXN0c31cbiAgICAgICAgICBvbkJsdXI9e3RoaXMuaGlkZVN1Z2dlc3RzfSAvPlxuICAgICAgICA8dWwgY2xhc3NOYW1lPXt0aGlzLmdldFN1Z2dlc3RzQ2xhc3NlcygpfT5cbiAgICAgICAgICB7dGhpcy5nZXRTdWdnZXN0SXRlbXMoKX1cbiAgICAgICAgPC91bD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCB0aGUgc3VnZ2VzdCBpdGVtcyBmb3IgdGhlIGxpc3RcbiAgICogQHJldHVybiB7QXJyYXl9IFRoZSBzdWdnZXN0aW9uc1xuICAgKi9cbiAgZ2V0U3VnZ2VzdEl0ZW1zOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5zdWdnZXN0cy5tYXAoZnVuY3Rpb24oc3VnZ2VzdCkge1xuICAgICAgdmFyIGlzQWN0aXZlID0gKHRoaXMuc3RhdGUuYWN0aXZlU3VnZ2VzdCAmJlxuICAgICAgICBzdWdnZXN0LnBsYWNlSWQgPT09IHRoaXMuc3RhdGUuYWN0aXZlU3VnZ2VzdC5wbGFjZUlkKTtcblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPEF1dG9zdWdnZXN0SXRlbVxuICAgICAgICAgIGtleT17c3VnZ2VzdC5wbGFjZUlkfVxuICAgICAgICAgIHN1Z2dlc3Q9e3N1Z2dlc3R9XG4gICAgICAgICAgaXNBY3RpdmU9e2lzQWN0aXZlfVxuICAgICAgICAgIG9uU3VnZ2VzdFNlbGVjdD17dGhpcy5zZWxlY3RTdWdnZXN0fSAvPlxuICAgICAgKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUaGUgY2xhc3NlcyBmb3IgdGhlIHN1Z2dlc3RzIGxpc3RcbiAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgY2xhc3Nlc1xuICAgKi9cbiAgZ2V0U3VnZ2VzdHNDbGFzc2VzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2xhc3NlcyA9ICdhdXRvc3VnZ2VzdF9fc3VnZ2VzdHMnXG5cbiAgICBjbGFzc2VzICs9IHRoaXMuc3RhdGUuaXNTdWdnZXN0c0hpZGRlbiA/XG4gICAgICAnIGF1dG9zdWdnZXN0X19zdWdnZXN0cy0taGlkZGVuJyA6ICcnO1xuXG4gICAgcmV0dXJuIGNsYXNzZXM7XG4gIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEF1dG9zdWdnZXN0O1xuIl19
